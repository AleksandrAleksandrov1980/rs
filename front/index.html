<!DOCTYPE html>
<html lang="ru">
<!---see https://medium.com/@gottfrois/temporary-queues-with-rabbitmq-using-web-stomp-e98e266d61e1 
sokjs-->
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <title> RastrW admin </title>
    <!-- Custom fonts for this template-->
    <link href="vendor/fontawesome-free/css/all.min.css" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i" rel="stylesheet">
    <!-- Custom styles for this template-->
    <link href="css/sb-admin-2.min.css" rel="stylesheet">

	  <!-- Custom styles for this page -->
    <link href="vendor/datatables/dataTables.bootstrap4.min.css" rel="stylesheet"> <!-- стрелочки сортировки в таблице -->


    <!-- StompJs.begin -->
    <script src="https://cdn.jsdelivr.net/npm/@stomp/stompjs@5.0.0/bundles/stomp.umd.js" type="text/javascript"> </script>
    <script type = "text/javascript" language = "javascript">
        
      var subscription;
      var nCounter = 0;
      var nCounterMsgs = 0;
      const g_enCOMMDANDS = Object.freeze({
        STATE            : "STATE",
        RUN_PROC         : "RUN_PROC",
        EXTERMINATE_PROC : "EXTERMINATE_PROC",
        CREATE_DIR       : "CREATE_DIR",
        CLEAR_DIR        : "CLEAR_DIR",
        GRAM_START       : "GRAM_START",
        GRAM_STOP        : "GRAM_STOP",
        GRAM_KIT         : "GRAM_KIT",
        GRAM_STATE       : "STATE",
      });
      
      //alexandrov-7k
      //brokerURL: 'ws://192.168.1.59:15674/ws',
      //brokerURL  : 'ws://alexandrov-7k:15674/ws',
      const client = new StompJs.Client({
        brokerURL: 'ws://192.168.1.59:15674/ws',
        connectHeaders: {
          login    : 'rastr',
          passcode : 'rastr',
        },
        reconnectDelay:    1000,
        heartbeatIncoming: 4000,
        heartbeatOutgoing: 4000,
        debug: function (str){
          //console.log(str);
        },
       });

      client.onConnect = function (frame) {
         // Do something, all subscribes must be done is this callback
         // This is needed because this will be executed after a (re)connect
         console.log('connected');
         subscription = client.subscribe('/exchange/logs', callback_subscribe_logs);
      };
       
      client.onStompError = function (frame) {
        // Will be invoked in case of error encountered at Broker
        // Bad login/passcode typically will cause an error
        // Complaint brokers will set `message` header with a brief message. Body may contain details.
        // Compliant brokers will terminate the connection after any error
        console.log('Broker reported error: ' + frame.headers['message']);
        console.log('Additional details: ' + frame.body);
      };

      function AddLog(str_log) {
        let collapseCard = document.querySelector("#collapseCard");
        if( nCounter++ > 30 ){ 
            collapseCard.innerText = "";
            nCounter = 0;
        }
        collapseCard.innerHTML += str_log.toString()+ "<BR/>";
      }

      callback_subscribe_logs = function(message){
        if (message.body){
          console.log('got message with body ' + message.body);
          nCounterMsgs++;
          AddLog( "< " +nCounterMsgs.toString()+ " : " + message.body );
        } else {
          console.log('got empty message');
        }
      };
      client.activate();

      var g_n_counter_seneded_msgs = 0;

      function SendCommand(en_command, str_params){
        strData = `> ${en_command} : '${str_params}'`;
        let bl_error = true;
        for(let en in g_enCOMMDANDS) {
          if(en === en_command){
            bl_error = false;
            break;
          }
        }
        if(bl_error === true){
          alert(`error. get unknown command ${strData}`);  
          return;
        }
        // trying to publish a message when the broker is not connected will throw an exception
        if(!client.connected){
          //alert("Broker disconnected, can't send message.");
          return ;
        }
        g_n_counter_seneded_msgs++;
        var currentdate = new Date(); 
        var datetime = " timestamp: " +  currentdate.getFullYear() +"/"
                + (currentdate.getMonth()+1)  + "/" 
                + currentdate.getDate() + " @ "  
                + currentdate.getHours() + ":"  
                + currentdate.getMinutes() + ":" 
                + currentdate.getSeconds() + ":"
                +currentdate.getMilliseconds();
                
        str_params_to_serialize = str_params +" : " + g_n_counter_seneded_msgs.toString() + " : " + datetime;
        const payLoad = JSON.stringify({ str_command: en_command, str_pars: str_params_to_serialize });
        client.publish({destination: '/exchange/logs', body: payLoad });
      }

      async function Sleep(ms) {
        return new Promise(resolve => setTimeout(resolve, ms));
      }

      var g_prms_cycle_scn1 = undefined;
      var g_bl_cycle_scn1_exit = false;
      async function AsyncLunchCycleScn1(){
        if(g_prms_cycle_scn1 !== undefined)
          return ;
        return  new Promise( async p1 => {
          for(;;)
          {
            PlayScn1();
            await Sleep(1000);
            if(g_bl_cycle_scn1_exit == true){
              g_bl_cycle_scn1_exit = false;
              g_prms_cycle_scn1 = undefined;
              break;
            }
          }
        });
      }

      function AsyncStopCycleScn1(){
        g_bl_cycle_scn1_exit = true;
      }

      async function PlayScn1(){
        let delay = 1000;
        AddLog('<------------- Scn1.begin ------------------>');
        await Sleep(delay);
        SendCommand(g_enCOMMDANDS.STATE,"");
        await Sleep(delay);
        SendCommand(g_enCOMMDANDS.GRAM_STATE, "c:\\program files(x86)\\rastrwin3.exe -weer -erer" );
        SendCommand(g_enCOMMDANDS.GRAM_START,"");
        await Sleep(delay);
        SendCommand(g_enCOMMDANDS.GRAM_START,"");
        await Sleep(delay);
        SendCommand(g_enCOMMDANDS.GRAM_STOP,"");
        await Sleep(delay);
        SendCommand(g_enCOMMDANDS.GRAM_KIT,"");
        await Sleep(delay);
        SendCommand(g_enCOMMDANDS.GRAM_START,"");
        await Sleep(delay);
        SendCommand(g_enCOMMDANDS.GRAM_STATE,"");
        await Sleep(delay);
        SendCommand(g_enCOMMDANDS.GRAM_KIT,"");
        await Sleep(delay);
        SendCommand(g_enCOMMDANDS.GRAM_STATE,"");
        await Sleep(delay);
        SendCommand(g_enCOMMDANDS.GRAM_STOP,"");
        await Sleep(delay);
        SendCommand(g_enCOMMDANDS.GRAM_KIT,"");
        await Sleep(delay);
        SendCommand(g_enCOMMDANDS.STATE,"");
        await Sleep(1000);
        //SendCommand(g_enCOMMDANDS.GRAM_START,"");
        AddLog('<------------- Scn1.end. ------------------>');
        await Sleep(delay);
      }

      function PlayScn2(){
        AddLog('<------------- Scn2.begin ------------------>');
        SendCommand(g_enCOMMDANDS.STATE,"");
        AddLog('<------------- Scn2.end. ------------------>');
      }

      function PlayScn3(){
        AddLog('<------------- Scn3.begin ------------------>');
        SendCommand(g_enCOMMDANDS.STATE,"");
        AddLog('<------------- Scn3.end. ------------------>');
      }

      function SendCom(){
        strData = '*********************************';
        // trying to publish a message when the broker is not connected will throw an exception
        if (!client.connected) {
          alert("Broker disconnected, can't send message.");
          return ;
        }
        if (strData.length > 0) {
          //const payLoad = { user: user, message: message };
          const payLoad = { user: "dfdfd", message: strData };
          // You can additionally pass headers
          //stompClient.publish({destination: '/topic/chat', body: JSON.stringify(payLoad)});
          client.publish({destination: '/exchange/logs', body: JSON.stringify(payLoad)});
        }
      }

    </script>
    <!-- StompJs.end. -->

  </head>
  
  <body id="page-top" style="background-color: white;">
    <!-- Page Wrapper -->
    <div id="wrapper">
	  <!--  XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX  -->
      <!-- Sidebar -->
      <ul class="navbar-nav bg-gradient-primary sidebar sidebar-dark accordion" id="accordionSidebar"> 
        <!-- Sidebar - Brand -->
		    <a class="sidebar-brand d-flex align-items-center justify-content-center"  href="index.html">
		    <img title="RastrW.3" src="./img/RastrWin3_32x32.ico" />
        <div class="sidebar-brand-text mx-3"> Rastr.W <sup>3</sup></div>
        </a>
        <!-- Divider -->
        <hr class="sidebar-divider my-0">
        <!-- Divider -->
        <hr class="sidebar-divider">
        <!-- Nav Item - Tables -->
        <li class="nav-item active"> <a class="nav-link" href="tables.html"> <i class="fas fa-fw fa-table"></i> <span> Tables </span> </a> </li>
        <!-- Divider -->
        <hr class="sidebar-divider d-none d-md-block">
        <!-- Sidebar Toggler (Sidebar) -->
        <div class="text-center d-none d-md-inline"> <button class="rounded-circle border-0" id="sidebarToggle"></button> </div>
      </ul>
      <!-- End of Sidebar -->
	  
	  <!--  XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX  -->
	  
      <!-- Content Wrapper -->
      <div id="content-wrapper" class="d-flex flex-column">
        <!-- Main Content -->
        <div id="content">
          <!-- Topbar -->
          <nav class="navbar navbar-expand navbar-light bg-white topbar mb-4 static-top shadow">
            <!-- Sidebar Toggle (Topbar) -->
			      <!-- <button id="sidebarToggleTop" class="btn btn-link d-md-none rounded-circle mr-3"> WWWWW        </button> -->
			      <!-- Topbar Search -->
            <ul class="navbar-nav ml-auto">
              <li class="nav-item dropdown no-arrow mx-1"><a class="nav-link dropdown-toggle" href="#" id="alertsDropdown" role="button" data-toggle="dropdown"  aria-haspopup="true" aria-expanded="false"> </a>
              <!-- Nav Item - User Information -->
              <li class="nav-item dropdown no-arrow"> 
                <a class="nav-link dropdown-toggle" href="#" id="userDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"> 
                <span class="mr-2 d-none d-lg-inline text-gray-600 small"> Douglas McGee </span> 
                <img class="img-profile rounded-circle" src="img/undraw_profile.svg">
                </a>
                <!-- Dropdown - User Information -->
                <div class="dropdown-menu dropdown-menu-right shadow animated--grow-in" aria-labelledby="userDropdown"> 
				        <a class="dropdown-item" href="#"> <i class="fas fa-user fa-sm fa-fw mr-2 text-gray-400"></i> Profile </a> 
				        <a class="dropdown-item" href="#"> <i class="fas fa-cogs fa-sm fa-fw mr-2 text-gray-400"></i> Settings </a> 
				        <!-- <a class="dropdown-item" href="#"> <i class="fas fa-list fa-sm fa-fw mr-2 text-gray-400"></i> Activity Log </a> -->
                <!-- <div class="dropdown-divider"></div> -->
				        <a class="dropdown-item" href="#" data-toggle="modal" data-target="#logoutModal"> <i class="fas fa-sign-out-alt fa-sm fa-fw mr-2 text-gray-400"></i> Logout </a> 
				        <a class="dropdown-item" href="#" data-toggle="modal" data-target="#loginModal">  <i class="fas fa-sign-in-alt fa-sm fa-fw mr-2 text-gray-400"></i> LogIn  </a> 
			          </div> 
              </li>
            </ul>
          </nav>
          <!-- End of Topbar -->
		  
		  <!--  XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX  -->
		  
          <!-- Begin Page Content -->
          <div class="container-fluid">
            <!-- Page Heading -->
            <div class="d-sm-flex align-items-center justify-content-between mb-4">
             <div> <h1 class="h3 mb-0 text-gray-800"> DATA !</h1> 

             <div>
              <div class="container">
                <button type="button" class="btn btn-info btn-round" data-toggle="modal" data-target="#loginModal">
                  Login
                </button>  
                <button type="button" class="btn btn-info btn-round" data-toggle="modal" onclick="GetData('user')" >
                  Get Data-> user
                </button>
                <button type="button" class="btn btn-info btn-round" data-toggle="modal" onclick="GetData('car')" > 
                  Get Data-> car 
                </button>
              </div>
            </div>

				 <!--  XXXXXXXXXXXXXXXXXXXXXXXX-DataTable.begin-XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX  -->
				 <div class="card shadow mb-4">
				   <div class="card-header py-3">
             <h6 class="m-0 font-weight-bold text-primary">
				        MyDataTables Example
					   </h6>
           </div>
				 <div>
           <div class="card-body">
             <div class="table-responsive">
               <table id="r_table" class="table table-bordered"  width="100%">
                 <thead>
                   <tr> <!--
                     <th>Name</th>
                     <th>Position</th>
                     <th>Office</th>
                     <th>Age</th>
                     <th>Start date</th>
                     <th>Salary</th> -->
                   </tr>
                 </thead>
               </table>
             </div>
            </div>
          </div>  
         </div>
         <!--  XXXXXXXXXXXXXXXXXXXXXXXX-DataTable.end.-XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX  -->

         <!--  XXXXXXXXXXXXXXXXXXXXXXXX-ButtonsBrokerCmnd.begin-XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX  -->
         <div class="container">
           <!--   
            STATE
            RUN_PROC
            EXTERMINATE_PROC,
            CREATE_DIR
            CLEAR_DIR
            GRAM_START
            GRAM_STOP
            GRAM_STATE
          -->
          <button type="button" class="btn btn-info btn-round" data-toggle="modal" onclick="SendCommand('STATE');">
            STATE
          </button>
          <button type="button" class="btn btn-info btn-round" data-toggle="modal" onclick="SendCommand('RUN_PROC');">
            RUN_PROC
          </button>
          <button type="button" class="btn btn-info btn-round" data-toggle="modal" onclick="SendCommand('EXTERMINATE_PROC');">
            EXTERMINATE_PROC
          </button>
          <button type="button" class="btn btn-info btn-round" data-toggle="modal" onclick="SendCommand('CREATE_DIR');">
            CREATE_DIR
          </button>
          <button type="button" class="btn btn-info btn-round" data-toggle="modal" onclick="SendCommand('CLEAR_DIR');">
            CLEAR_DIR
          </button>  

          <button type="button" class="btn btn-info btn-round" data-toggle="modal" onclick="SendCommand('GRAM_START');">
            GRAM_START
          </button>  
          <button type="button" class="btn btn-info btn-round" data-toggle="modal" onclick="SendCommand('GRAM_STOP');">
            GRAM_STOP
          </button>  
          <button type="button" class="btn btn-info btn-round" data-toggle="modal" onclick="SendCommand('GRAM_KIT');">
            GRAM_KIT
          </button>  
          <button type="button" class="btn btn-info btn-round" data-toggle="modal" onclick="SendCommand('GRAM_STATE');">
            GRAM_STATE
          </button>  

          <button type="button" class="btn btn-info btn-round" data-toggle="modal" onclick="PlayScn1();">
            PlayScn1
          </button> 
          <button type="button" class="btn btn-info btn-round" data-toggle="modal" onclick="PlayScn2();">
            PlayScn2
          </button> 
          <button type="button" class="btn btn-info btn-round" data-toggle="modal" onclick="PlayScn3();">
            PlayScn3
          </button> 
          
          <button type="button" class="btn btn-info btn-round" data-toggle="modal" onclick="g_prms_cycle_scn1 = AsyncLunchCycleScn1();">
            CyclePlayScn1.begin!
          </button> 
          <button type="button" class="btn btn-info btn-round" data-toggle="modal" onclick="AsyncStopCycleScn1();">
            CyclePlayScn1.end.
          </button> 

        </div>
        <!--  XXXXXXXXXXXXXXXXXXXXXXXX-ButtonsBrokerCmnd.end.-XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX  -->

         <!-- XXXXXXXXXXXXXXXXXXXXXXXX Collapsable Card.begin  XXXXXXXXXXXXXXXXXXXXXXXX -->
         <div class="card shadow mb-4">
         <!-- Card Header - Accordion -->
         <a href="#collapseCard" class="d-block card-header py-3" data-toggle="collapse"
             role="button" aria-expanded="true" aria-controls="collapseCard">
             <h6 class="m-0 font-weight-bold text-primary"> Сообщения брокера. </h6>
         </a>
         <!-- Card Content - Collapse -->
         <div class="collapse show" id="collapseCard">
           <div class="card-body">
             <!--  здесь будут выводится сообщения брокера. -->
           </div>
         </div>
         </div>
         <!-- XXXXXXXXXXXXXXXXXXXXXXXX Collapsable Card.end. XXXXXXXXXXXXXXXXXXXXXXXX -->

          </div>
          <!-- /.container-fluid --> </div>
        <!-- End of Main Content -->

		<!--  XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX  -->
        <!-- Footer -->
        <footer class="sticky-footer bg-white">
          <div class="container my-auto">
            <div class="copyright text-center my-auto">
			        <span> Copyright © Rastr.W3 2022 </span> 
			      </div>
          </div>
        </footer>
        <!-- End of Footer --> </div>
		<!--  XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX  -->

    <!-- End of Content Wrapper --> </div>
	  
	  <!--  XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX  -->
    <!-- End of Page Wrapper -->
    <!-- Scroll to Top Button--> 
	<a class="scroll-to-top rounded" href="#page-top"> </a>
	
	<!-- Login Modal -->
	<div class="modal fade" id="loginModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
	  <div class="modal-dialog modal-dialog-centered" role="document">
		<div class="modal-content">
		  <div class="modal-header border-bottom-0">
			<button type="button" class="close" data-dismiss="modal" aria-label="Close">
			  <span aria-hidden="true">&times;</span>
			</button>
		  </div>
		  <div class="modal-body">
			<div class="form-title text-center">
			  <h4>Login</h4>
			</div>
			<div class="d-flex flex-column text-center">
			  <form>
				<div class="form-group"> <input type="text" class="form-control" id="name1"  value="nname"> </div>
				<div class="form-group"> <input type="password" class="form-control" id="password1" value="ppasw" placeholder="Your password...">	</div>
				<div class="form-group"> <button type="button" class="btn btn-info btn-block btn-round" onclick="GetTkn()" data-dismiss="modal" >Login</button> </div>
			  </form>
			</div>
		  </div>
		</div>
	  </div>
	</div>
	
    <!-- Logout Modal-->
    <div class="modal fade" id="logoutModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">Ready to Leave?</h5>
            <button class="close" type="button" data-dismiss="modal" aria-label="Close"> <span aria-hidden="true">×</span> </button> 
	      </div>
          <div class="modal-body">Select "Logout" below if you are ready to end your current session.</div>
          <div class="modal-footer"> 
		    <button class="btn btn-secondary" type="button" data-dismiss="modal">Cancel</button> <a class="btn btn-primary" href="login.html">Logout</a>
          </div>
        </div>
      </div>
    </div>
	
    <!-- Bootstrap core JavaScript-->
    <script src="vendor/jquery/jquery.min.js"></script>
    <script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
    <!-- Core plugin JavaScript-->
    <script src="vendor/jquery-easing/jquery.easing.min.js"></script>
    <!-- Custom scripts for all pages-->
    <script src="js/sb-admin-2.min.js"></script>
	
	<script>
	  var g_str_jwt_tkn = 'no';
		
    function httpGet(theUrl){
      var xmlHttp = new XMLHttpRequest();
      xmlHttp.open( "GET", theUrl, false ); // false for synchronous request
      xmlHttp.send( null );
      return xmlHttp.responseText;
    }
		
    function httpGetAsync(theUrl, callback, use_tkn){
      var xmlHttp = new XMLHttpRequest();
      xmlHttp.onreadystatechange = function(){ 
        if (xmlHttp.readyState == 4 && xmlHttp.status == 200)
        callback(xmlHttp.responseText);
      }
      xmlHttp.open("GET", theUrl, true); // true for asynchronous 
      if(use_tkn === true){
        let str_jwt_tkn = localStorage.getItem('jwt_token');
        if( isstring(str_jwt_tkn) === true){
          //xmlHttp.setRequestHeader("Access-Control-Allow-Origin", "*");
          //xmlHttp.setRequestHeader("Access-Control-Allow-Methods", "GET,HEAD,OPTIONS,POST,PUT");
          //xmlHttp.setRequestHeader("Access-Control-Allow-Headers", "Origin, X-Requested-With, Content-Type, Accept, Authorization");
          //headers = curl_slist_append( headers, "Content-Type: application/json;charset=UTF-8" );
          //xmlHttp.setRequestHeader('Content-Type', 'application/json;charset=UTF-8');	
          //xmlHttp.setRequestHeader('charset=UTF-8');	
          xmlHttp.setRequestHeader('authorization', 'Bearer ' + str_jwt_tkn);	
        }
      }
      xmlHttp.send(null);
    }
		
	  function cb_get_tkn(resTxt){
      let obj = JSON.parse(resTxt);
      console.log('get_tkn-> '+obj.token);
      g_str_jwt_tkn = obj.token;
      localStorage.setItem('jwt_token', g_str_jwt_tkn); // write
      console.log(localStorage.getItem('jwt_token')); // read
	  }
		
	  function GetTkn(){
        //curl "http://alexandrov-7k/be/i/user/create?name=hello&password=1fdsfsd45r&email=werwere@mil.ru" > tkh.txt
      let name_el   = document.getElementById('name1');
      let str_name  = name_el?.value;
      let str_email = str_name;
      let passw_el  = document.getElementById('password1');
      let str_passw = passw_el.value;
      //alert("Кролик номер 1["+ window.location.hostname+"/be/i"+"]-> "+ "name:["+str_name + "] passw:["+str_passw + "] email:"+str_email );
      let str_req = 'http://alexandrov-7k/be/i/user/create?name='+str_name+'&password='+str_passw+'&email='+str_email;
      //let str_req = window.location.hostname  +'/be/i/user/create?name='+str_name+'&password='+str_passw+'&email='+str_email;
	    console.log('str_req->'+str_req );
		  //httpGet( str_req);
      httpGetAsync(str_req, cb_get_tkn, false);
	  }

	  function isobject(A){
      if( (typeof A === "object" || typeof A === 'function') && (A !== null) ) {
        return true;
      }
      return false;
	  }

	  function isstring(S){
      if( (typeof S === "string" ) && (S !== null) ) {
        return true;
      }
      return false;
	  }

	  function cb_data(resTxt){
		  console.log('cb_data()-> '+resTxt);
		  let arrObjs = JSON.parse(resTxt);
		  r_table_populate_from_arr_objs(arrObjs);
	  }

	  function GetData(strParam){
      console.log('click.GetData()');
		  if( isstring(g_str_jwt_tkn) === false )
		  {
	      return console.log('no.tkn!');
		  }
  		//let str_req = 'http://alexandrov-7k/be/i/user/';
		  let str_req = 'http://alexandrov-7k/be/i/'+strParam+'/';
		  console.log('str_req->'+str_req );
      httpGetAsync( str_req, cb_data, true);
		  //SET TKN="Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpYXQiOjE2NDg4ODM1NjksImV4cCI6MTY1MTQ3NTU2OX0.YnaretUtVV3OgYLs21lDIhwn8iq730X1aHsowcQcbVY"
	  }

    function r_table_populate_from_arr_objs( arrObjs ){
      if ( $.fn.dataTable.isDataTable( '#r_table' ) ) {
        table = $('#r_table').DataTable();
        table.destroy();	
      }
      //console.log(Object.keys(arrObjs[0]));
      let columns = [];
      for (let key of Object.keys(arrObjs[0])) {
      columns.push({ data: key, title: key} );
      }	
      $(document).ready(function() {
        $('#r_table').DataTable( {
          data: arrObjs, 
          columns
        } );
      });
    }

	  function PopulateTable(){
		  let dataSet = [
		    [ "Tiger Nixon", "System Architect", "Edinburgh", "5421", "2011/04/25", "$320,800" ],
		    [ "Garrett Winters", "Accountant", "Tokyo", "8422", "2011/07/25", "$170,750" ],
		    [ "Brenden Wagner", "Software Engineer", "San Francisco", "1314", "2011/06/07", "$206,850" ],
		    [ "Fiona Green", "Chief Operating Officer (COO)", "San Francisco", "2947", "2010/03/11", "$850,000" ],
		    [ "Shou Itou", "Regional Marketing", "Tokyo", "8899", "2011/08/14", "$163,000" ],
		    [ "Michelle House", "Integration Specialist", "Sydney", "2769", "2011/06/02", "$95,400" ],
		    [ "Suki Burks", "Developer", "London", "6832", "2009/10/22", "$114,500" ],
		    [ "Prescott Bartlett", "Technical Author", "London", "3606", "2011/05/07", "$145,000" ],
		    [ "Gavin Cortez", "Team Leader", "San Francisco", "2860", "2008/10/26", "$235,500" ],
		    [ "Martena Mccray", "Post-Sales support", "Edinburgh", "8240", "2011/03/09", "$324,050" ],
		    [ "Unity Butler", "Marketing Designer", "San Francisco", "5384", "2009/12/09", "$85,675" ]
		  ];
      let i = 0;
      for (let i = 0; i < 3000; i++) {
        dataSet.push( [ i, "Martena Mccray "+i, "Post-Sales support", "Edinburgh", "8240", "2011/03/09", "$324,050"] );
      }
      if ( $.fn.dataTable.isDataTable( '#r_table' ) ) {
        table = $('#r_table').DataTable();
        table.destroy();	
      }
        
      let dataSetMy = [
        {
        "createdAt":1649166689390,
        "updatedAt":1649166689390,
        "id":27,
        "email":"werwere@mil.ru",
        "name":"11111hello",
        "description":"",
        "password":"1fdsfsd45r"
        },
        {
        "createdAt":1649166689390,
        "updatedAt":1649166689390,
        "id":27,
        "email":"werwere@mil.ru",
        "name":"11111hello",
        "description":"d2",
        "password":"1fdsfsd45r"
        },
      ];

      console.log(Object.keys(dataSetMy[0]));

      r_table_populate_from_arr_objs(dataSetMy);
      return ;
        
      $(document).ready(function() {
        $('#r_table').DataTable( {
          data: dataSetMy, 
              columns: [
                { data: "createdAt",    title: "createdAt",}, 
                { data: "updatedAt",    title: "updatedAt",}, 
                { data: "id",           title: "id", }, 
                { data: "email",        title: "email", }, 
                { data: "name",         title: "name",}, 
                { data: "description",  title: "description", }, 
                { data: "password",     title: "password", }, 
              ]  
        } );
      });
	  }
	</script>
	
    <!-- Page level plugins -->
    <!--  <script src="vendor/chart.js/Chart.min.js"></script> -->
    <!-- Page level custom scripts -->
    <!--<script src="js/demo/chart-area-demo.js"></script> -->
    <!--<script src="js/demo/chart-pie-demo.js"></script> -->

     <!-- Page level plugins -->
    <script src="vendor/datatables/jquery.dataTables.min.js"></script>
    <script src="vendor/datatables/dataTables.bootstrap4.min.js"></script>

    <!-- Page level custom scripts -->
    <script src="js/demo/datatables-demo.js"></script> 
		  
  </body>
</html>
